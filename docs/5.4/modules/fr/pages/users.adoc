= Utilisateurs et rôles
:revdate1: 2025-01-10
:page-revdate: {revdate}
:page-opendocs-origin: /03.configuration/02.users/02.users.md
:page-opendocs-slug: /configuration/utilisateurs

== Configuration des utilisateurs et des rôles personnalisés

Le menu Settings -> Users and Roles permet de gérer les utilisateurs et les rôles. Chaque utilisateur se voit attribuer un rôle prédéfini ou personnalisé. Les utilisateurs peuvent être associés à des rôles par le biais d'une intégration de groupe avec LDAP/AD ou d'autres intégrations de systèmes SSO. Voir la section xref:integration.adoc#_directorysso_integration[Intégration d'entreprise] pour des instructions détaillées pour chaque type d'intégration d'annuaire ou de SSO.

=== Utilisateurs

Les utilisateurs peuvent être configurés directement dans {product-name} ou intégrés par le biais d'annuaires/SSO. Pour créer un nouvel utilisateur dans {product-name}, allez dans Settings -> Users & Roles et ajoutez l'utilisateur. Sélectionnez le rôle de l'utilisateur parmi les rôles prédéfinis, ou voyez ci-dessous pour créer un rôle personnalisé.

Le mot de passe par défaut doit comporter au moins 8 caractères, 1 lettre majuscule, 1 lettre minuscule et 1 caractère numérique. Ces exigences, ainsi que d'autres, peuvent être modifiées par un administrateur dans les paramètres -> Users sous Authentication and Security Policies (politiques d'authentification et de sécurité).

=== Espace de noms Utilisateurs restreints

Les utilisateurs peuvent être limités à certains espaces de noms. Sélectionnez d'abord le rôle global (utilisez "aucun" si vous ne souhaitez pas de rôle global), puis cliquez sur les paramètres avancés.

Sélectionnez un nom de rôle dans la liste des rôles, puis saisissez le(s) espace(s) de noms que l'utilisateur a autorisé(s). Par exemple, le rôle ci-dessous est celui d'un lecteur global (vue seule), mais pour l'espace de noms "demo", l'utilisateur a des droits d'administrateur et pour l'espace de noms "staging", l'utilisateur a des droits CI/Ops. Si un rôle personnalisé a été configuré précédemment, il peut également être sélectionné.

image:namespace_user_4.png[namespace_user]

[NOTE]
====
Si un utilisateur s'est précédemment connecté par le biais d'une intégration d'entreprise, son fournisseur d'identification (par exemple OpenID Connect) sera répertorié. Un utilisateur peut être promu administrateur fédéré si la gestion multi-clusters est utilisée en sélectionnant l'utilisateur et en le modifiant.
====

[NOTE]
====
Lorsqu'un utilisateur limité à l'espace de noms configure un registre dans Assets à l'adresse {product-name}, seuls les utilisateurs ayant accès à cet espace de noms peuvent voir/scannériser ce registre. Les utilisateurs globaux pourront voir/gérer ce registre, mais pas les utilisateurs ayant des espaces de noms/rôles restreints.
====

=== Rôles

Les rôles préconfigurés comprennent Admin, Reader et CI/Ops. Pour créer un nouveau rôle personnalisé, sélectionnez l'onglet Rôles dans Paramètres -> Utilisateurs et rôles. Nommez le rôle et ajoutez-y l'autorisation de lecture ou d'écriture appropriée.

image:roles_4.png[rôles]

=== Permissions RBAC

* Contrôle d'admission. Gérer les règles de contrôle d'admission.
* Événements d'audit. Voir la notification -> Journaux des rapports sur les risques.
* Authentification. Activer la configuration de l'annuaire et du SSO (oidc/saml/ldap).
* Autorisation. Créer de nouveaux utilisateurs et des rôles personnalisés.
* CI Scan. Permet de numériser des images par l'intermédiaire de l'API REST. Utile pour configurer l'utilisateur d'un scanner plug-in en phase de construction.
* Conformité. Créer des scripts de conformité personnalisés et examiner les résultats des contrôles de conformité.
* Événement. Accéder aux notifications -> Journaux d'événements.
* Analyse du registre. Configurer l'analyse du registre et afficher les résultats.
* Politique d'exécution. Gestion des menus de politique pour le mode de politique (découverte, surveillance, protection), les règles de réseau, les règles de processus, les règles d'accès aux fichiers, la DLP, la capture de paquets, les règles de réponse.
* Analyse de la durée d'exécution. Déclenchement et visualisation de l'analyse des vulnérabilités des conteneurs/nœuds/plateformes au moment de l'exécution.
* Événement de sécurité. Notifications d'accès -> Journaux des événements de sécurité.
* Config. système Autoriser la configuration des paramètres -> Configuration.

=== Mappage des groupes aux rôles et aux espaces de noms

Les groupes peuvent être associés à des rôles prédéfinis ou personnalisés sur le site {product-name}. En outre, un rôle peut être limité à un ou plusieurs espaces de noms.

Dans la configuration LDAP/AD, SAML ou OIDC dans Paramètres, la dernière section de l'écran de configuration associe les groupes aux rôles et aux espaces de noms. Sélectionnez d'abord un rôle par défaut, le cas échéant, pour le mappage.

image:groups_default_role.png[Rôle par défaut]

Pour associer un groupe à un rôle et à un espace de noms, cliquez sur Ajouter pour créer une nouvelle association. Sélectionnez un rôle global ou aucun. Si admin ou FedAdmin est sélectionné, cela donne un accès en écriture à tous les espaces de noms. Si un rôle différent est sélectionné, il peut être restreint davantage en sélectionnant le(s) espace(s) de noms souhaité(s).

image:group_role_map_namespace.png[AddMapping]

L'exemple suivant présente quelques correspondances possibles. Demo_admin peut lire et consulter tous les espaces de noms, mais il a des droits d'administrateur sur les espaces de noms demo et demo2. System_admin n'a que des droits d'administrateur sur l'espace de noms kube-system.  Et fed_admins a le rôle fedAdmin prédéfini qui donne un accès en écriture à toutes les ressources à travers plusieurs clusters.

image:group_role_map_examples.png[Exemples de cartographie]

[IMPORTANT]
====
Si l'utilisateur fait partie de plusieurs groupes, le rôle sera attribué en premier dans l'ordre de la liste et le rôle du groupe sera attribué. Veuillez ajuster l'ordre de configuration pour un comportement correct en glissant et déposant les mappages dans l'ordre approprié de la liste.
====

=== FedAdmin multi-clusters et rôles d'administration pour la gestion primaire et à distance

Lorsqu'un cluster est xref:multicluster.adoc[promu] en cluster primaire, l'administrateur devient automatiquement FedAdmin. Le FedAdmin peut effectuer des opérations sur le primaire telles que la génération d'un jeton de fédération pour connecter un cluster distant ainsi que la création de règles de sécurité fédérées telles que des règles de réseau, de processus, de fichiers et de contrôle d'admission.

Les rôles de gestion des grappes multiples sont les suivants :

* Sur n'importe quel cluster, un administrateur local ou un administrateur Rancher SSO peut promouvoir le cluster pour qu'il devienne primaire.
* Les utilisateurs de Ldap/SSO/SAML/OIDC ayant un rôle d'administrateur ne sont pas en mesure de promouvoir un cluster au niveau primaire.
* Seul FedAdmin peut générer le jeton nécessaire pour joindre un cluster distant au cluster primaire.
* Tout administrateur, y compris les utilisateurs ldap/sso/saml/oidc, peut joindre un cluster distant au cluster primaire s'il possède le jeton.
* Seul le FedAdmin peut créer un nouvel utilisateur en tant que FedAdmin (ou FedReader) ou attribuer le rôle de FedAdmin (ou FedReader) à un utilisateur existant (y compris les utilisateurs ldap/sso/saml/oidc).
